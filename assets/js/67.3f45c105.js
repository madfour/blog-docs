(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{517:function(v,_,o){"use strict";o.r(_);var e=o(27),c=Object(e.a)({},(function(){var v=this,_=v.$createElement,o=v._self._c||_;return o("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[o("ul",[o("li",[o("p",[v._v("浏览器根据请求的 "),o("code",[v._v("URL")]),v._v(" 交给 "),o("code",[v._v("DNS")]),v._v(" 域名解析，找到真实 "),o("code",[v._v("IP")]),v._v("，向服务器发起请求；")])]),v._v(" "),o("li",[o("p",[v._v("服务器交给后台处理完成后返回数据，浏览器接收文件（"),o("code",[v._v("HTML")]),v._v("、"),o("code",[v._v("JS")]),v._v("、"),o("code",[v._v("CSS")]),v._v("、图像等）；")])]),v._v(" "),o("li",[o("p",[v._v("浏览器对加载到的资源（"),o("code",[v._v("HTML")]),v._v("、"),o("code",[v._v("JS")]),v._v("、"),o("code",[v._v("CSS")]),v._v(" 等）进行语法解析，建立相对应的内部数据结构（如 "),o("code",[v._v("HTML")]),v._v(" 的 "),o("code",[v._v("DOM")]),v._v("）；")])]),v._v(" "),o("li",[o("p",[v._v("载入解析到的资源文件，渲染页面，完成。")])])]),v._v(" "),o("h2",{attrs:{id:"简版"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#简版"}},[v._v("#")]),v._v(" 简版")]),v._v(" "),o("ul",[o("li",[o("p",[v._v("1.从浏览器接收 "),o("code",[v._v("url")]),v._v(" 到开启网络请求线程（这一部分可以展开浏览器的机制以及进程与线程之间的关系）")])]),v._v(" "),o("li",[o("p",[v._v("2.开启网络线程到发出一个完整的"),o("code",[v._v("HTTP")]),v._v("请求（这一部分涉及到 dns 查询，"),o("code",[v._v("TCP/IP")]),v._v(" 请求，五层原因特网协议栈等知识）")])]),v._v(" "),o("li",[o("p",[v._v("3.从服务器接收到请求到对应后台接收到请求（这一部分可能涉及到负载均衡，安全拦截以及后台内部的处理等等）")])]),v._v(" "),o("li",[o("p",[v._v("4.后台和前台的 "),o("code",[v._v("HTTP")]),v._v(" 交互（这一部分包括 "),o("code",[v._v("HTTP")]),v._v(" 头部、响应码、报文结构、"),o("code",[v._v("cookie")]),v._v(" 等知识，可以提下静态资源的 "),o("code",[v._v("cookie")]),v._v(" 优化，以及编码解码，如"),o("code",[v._v("gzip")]),v._v("压缩等）")])]),v._v(" "),o("li",[o("p",[v._v("5.单独拎出来的缓存问题，"),o("code",[v._v("HTTP")]),v._v(" 的缓存（这部分包括 http 缓存头部，"),o("code",[v._v("ETag")]),v._v("，"),o("code",[v._v("catch-control")]),v._v(" 等）")])]),v._v(" "),o("li",[o("p",[v._v("6.浏览器接受到 "),o("code",[v._v("HTTP")]),v._v(" 数据包后的解析流程（解析"),o("code",[v._v("html")]),v._v(" -词法分析然后解析成 "),o("code",[v._v("dom")]),v._v(" 树、解析 "),o("code",[v._v("css")]),v._v(" 生存 "),o("code",[v._v("css")]),v._v(" 规则树、合并成 "),o("code",[v._v("render")]),v._v(" 树，然后 "),o("code",[v._v("layout")]),v._v("、"),o("code",[v._v("painting")]),v._v("渲染、复合图层的合成、"),o("code",[v._v("GPU")]),v._v(" 绘制、外链资源的处理、"),o("code",[v._v("loaded")]),v._v(" 和 "),o("code",[v._v("DOMContentLoaded")]),v._v(" 等）")])]),v._v(" "),o("li",[o("p",[v._v("7."),o("code",[v._v("CSS")]),v._v("的可视化格式模型（元素的渲染规则，如包含块，控制框，"),o("code",[v._v("BFC")]),v._v("，"),o("code",[v._v("IFC")]),v._v("等概念）")])]),v._v(" "),o("li",[o("p",[v._v("8."),o("code",[v._v("JS")]),v._v("引擎解析过程（"),o("code",[v._v("JS")]),v._v("的解释阶段，预处理阶段，执行阶段生存执行上下文，"),o("code",[v._v("V0")]),v._v("，作用域链、回收机制等等）")])]),v._v(" "),o("li",[o("p",[v._v("9.其它（可以拓展不同的知识模块，如跨域，web 安全，"),o("code",[v._v("hybrid")]),v._v("模式等等内容）")])])]),v._v(" "),o("h2",{attrs:{id:"详解"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#详解"}},[v._v("#")]),v._v(" 详解")]),v._v(" "),o("ul",[o("li",[o("p",[v._v("在浏览器地址栏输入 RUL")])]),v._v(" "),o("li",[o("p",[v._v("浏览器直接查看缓存，如果请求资源在缓存中并且新鲜，跳转到转码步骤")]),v._v(" "),o("ol",[o("li",[v._v("若资源未缓存，发起新请求。")]),v._v(" "),o("li",[v._v("若已经缓存，检验是否是足够新鲜，是的则直接提供给客户端，否则与服务器进行验证。")]),v._v(" "),o("li",[v._v("检验新鲜通常有两个 HTTP 头进行控制"),o("code",[v._v("Expires")]),v._v("和"),o("code",[v._v("Cache-Control")]),v._v(" "),o("ol",[o("li",[v._v("HTTP1.0 提供"),o("code",[v._v("Expires")]),v._v("，值为一个绝对时间，表示缓存新鲜日期。")]),v._v(" "),o("li",[v._v("HTTP1.1 增加了 "),o("code",[v._v("Cache-Control：max-age=")]),v._v(", 值为以每秒为单位的最大新鲜时间")])])])])]),v._v(" "),o("li",[o("p",[v._v("浏览器"),o("strong",[v._v("解析 URL")]),v._v("获取协议，主机，端口， path")])]),v._v(" "),o("li",[o("p",[v._v("浏览器"),o("strong",[v._v("组装一个 HTTP (GET) 请求报文")])])]),v._v(" "),o("li",[o("p",[v._v("浏览器"),o("strong",[v._v("获取主机 ip 地址")]),v._v("，过程如下：")]),v._v(" "),o("ol",[o("li",[v._v("浏览器缓存")]),v._v(" "),o("li",[v._v("本机缓存")]),v._v(" "),o("li",[v._v("hosts 文件")]),v._v(" "),o("li",[v._v("路由器缓存")]),v._v(" "),o("li",[v._v("ISP DNS 缓存")]),v._v(" "),o("li",[v._v("DNS 递归查询（可能存在负载均衡导致每次 IP 不一样）")])])]),v._v(" "),o("li",[o("p",[o("strong",[v._v("打开一个 socket 与目标 IP 地址，端口简历 TCP 连接")]),v._v("，三次握手如下：")]),v._v(" "),o("ol",[o("li",[v._v("客户端发送一个 TCP 的 "),o("code",[v._v("SYN=1， Seq=X")]),v._v("的包到服务器端口")]),v._v(" "),o("li",[v._v("服务器发回 "),o("code",[v._v("SYN=1, ACK=X=1 ,Seq=Y")]),v._v(" 的响应包")]),v._v(" "),o("li",[v._v("客户端发送"),o("code",[v._v("ACK=Y+1， Seq=Z")])])])]),v._v(" "),o("li",[o("p",[v._v("TCP 连接建立以后发送 HTTP 请求")])]),v._v(" "),o("li",[o("p",[v._v("服务器接受请求并解析，将请求转发到服务程序，如虚拟主机使用 HTTP Host 头部判断请求的服务程序")])]),v._v(" "),o("li",[o("p",[v._v("服务器检查 HTTP 请求头是否包含缓存验证信息，如果验证缓存新鲜，返回 304 等对应状态码")])]),v._v(" "),o("li",[o("p",[v._v("处理程序读取完整请求并准备 HTTP 响应，可能需要查询数据库等操作")])]),v._v(" "),o("li",[o("p",[v._v("处理器将响应报文通过 TCP 连接发送回浏览器")])]),v._v(" "),o("li",[o("p",[v._v("浏览器接受 HTTP 响应，然后根据情况选择关闭 TCP 连接或者保留重用，关闭 TCP 连接的四次握手如下：")]),v._v(" "),o("ol",[o("li",[v._v("主动方发送"),o("code",[v._v("Fin=1， Ack=Z, Seq=X")]),v._v("报文")]),v._v(" "),o("li",[v._v("被动方发送"),o("code",[v._v("ACK=X+1, Seq=Z")]),v._v("报文")]),v._v(" "),o("li",[v._v("被动方发送"),o("code",[v._v("Fin=1， ACK=X, Seq=Y")]),v._v(" 报文")]),v._v(" "),o("li",[v._v("主动方发送 "),o("code",[v._v("ACK=Y，Seq=X")]),v._v("报文")])])]),v._v(" "),o("li",[o("p",[v._v("浏览器检查响应状态码： 是否为"),o("code",[v._v("1XX, 3XX, 4XX, 5XX")]),v._v(" 这些情况处理与不同"),o("code",[v._v("2XX")])])]),v._v(" "),o("li",[o("p",[v._v("如果资源科缓存，进行缓存")])]),v._v(" "),o("li",[o("p",[v._v("对响应进行 解码（例如 gzip 压缩）")])]),v._v(" "),o("li",[o("p",[v._v("根据资源类型决定如何处理（假设资源未 HTML 文档）")])]),v._v(" "),o("li",[o("p",[o("strong",[v._v("解析 HTML 文档，构建 DOM 树，下载资源，构造 CSSOM 树， 执行 js 脚本")]),v._v("，这些操作没有严格的先后顺序，一下分别解释")])]),v._v(" "),o("li",[o("p",[o("strong",[v._v("构建 DOM 树：")])]),v._v(" "),o("ol",[o("li",[o("strong",[v._v("Tokenizing")]),v._v(": 根据 HTML 规范将字符流解析为标记")]),v._v(" "),o("li",[o("strong",[v._v("Lexington")]),v._v("： 此法分析将标记转换为对象并定义属性和规则")]),v._v(" "),o("li",[o("strong",[v._v("DOM constructio")]),v._v("n: 根据 HTML 标记关系将对象组成 DOM 树")])])]),v._v(" "),o("li",[o("p",[v._v("解析过程中遇到图片、样式表、js 文件、"),o("strong",[v._v("启动下载")])])]),v._v(" "),o("li",[o("p",[o("strong",[v._v("构建 CSSOM 树")]),v._v("：")]),v._v(" "),o("ol",[o("li",[o("strong",[v._v("Tokenizing")]),v._v("： 字符流转换为标记流")]),v._v(" "),o("li",[o("strong",[v._v("Node")]),v._v("： 根据标记创建节点")]),v._v(" "),o("li",[o("strong",[v._v("CSSOM")]),v._v("： 节点创建 CSSOM 树")])])]),v._v(" "),o("li",[o("p",[o("strong",[v._v("根据 DOM 树和 CSSOM 树构建渲染树：")])]),v._v(" "),o("ol",[o("li",[v._v("从 DOM 树的根节点遍历所有"),o("strong",[v._v("可见节点")]),v._v("，不可见节点包括：① "),o("code",[v._v("script")]),v._v(", "),o("code",[v._v("meta")]),v._v(" 这样本身不可见的标签。② 被 css 隐藏的节点，如： "),o("code",[v._v("display: none")])]),v._v(" "),o("li",[v._v("对每一个可见节点，找到恰当的"),o("code",[v._v("CSSOM")]),v._v(" 规则并应用。")]),v._v(" "),o("li",[v._v("发布可视节点的内容和计算样式")])])]),v._v(" "),o("li",[o("p",[v._v("JS 解析如下：")]),v._v(" "),o("ol",[o("li",[v._v("浏览器创建"),o("code",[v._v("Document")]),v._v(" 对象并解析"),o("code",[v._v("HTML")]),v._v("，将解析到的元素节点添加到文档中，此时"),o("code",[v._v("document.readystate")]),v._v(" 为 "),o("code",[v._v("loading")])]),v._v(" "),o("li",[o("code",[v._v("HTML")]),v._v("解析遇到没有 "),o("code",[v._v("async")]),v._v(" 和 "),o("code",[v._v("defer")]),v._v(" 的 "),o("code",[v._v("script")]),v._v(" 时，将他们添加到文档中，然后执行行内或外部脚本，这些脚本会同步执行，并且在脚本下载和执行时解析器会暂停。这样就可以用 "),o("code",[v._v("document.write()")]),v._v(" 把文本插入到输入流中。"),o("strong",[v._v("同步脚本经常简单定义函数和注册时间处理程序，他们可以遍历和操作 "),o("code",[v._v("script")]),v._v(" 和 他们之前的文档内容")])]),v._v(" "),o("li",[v._v("当解析器遇到设置了 "),o("strong",[v._v("async")]),v._v(" 属性的 script 时，开始下载脚本并继续解析文档。脚本会在它"),o("strong",[v._v("下载完成后尽快执行")]),v._v("，但是"),o("strong",[v._v("解析器不会停下来等他下载")]),v._v("。异步脚本"),o("strong",[v._v("禁止使用")]),v._v(" "),o("code",[v._v("document.write()")]),v._v(" 他们可以访问自己的 script 和之前的文档元素")]),v._v(" "),o("li",[v._v("当文档完成解析， "),o("code",[v._v("document.readState")]),v._v(" 变成 "),o("code",[v._v("interactive")])]),v._v(" "),o("li",[v._v("所有"),o("code",[v._v("defer")]),v._v(" 脚本会"),o("strong",[v._v("按照在文档出现的顺序执行")]),v._v("，延迟脚本能"),o("strong",[v._v("访问完整文档树")]),v._v("，禁止使用 "),o("code",[v._v("document.write()")])]),v._v(" "),o("li",[v._v("浏览器在 "),o("code",[v._v("Document")]),v._v(" 对象上触发 "),o("code",[v._v("DOMContentLoaded")]),v._v(" 事件")]),v._v(" "),o("li",[v._v("此文档完全解析完成，浏览器可能还在等待如图片等内容加载，等这些"),o("strong",[v._v("内容完成载入并且所有异步脚本完成载入和执行")]),v._v("，"),o("code",[v._v("document.readState")]),v._v(" 变为 "),o("code",[v._v("complete")]),v._v(" "),o("code",[v._v("window")]),v._v(" 触发 load 事件")])])]),v._v(" "),o("li",[o("p",[o("strong",[v._v("显示页面")]),v._v("（HTML 解析过程中会逐步显示页面）")])])])])}),[],!1,null,null,null);_.default=c.exports}}]);