---
title: 常用代码段
date: 2021-10-23 22:52:52
permalink: /JavaScript/d636fd/
categories:
  - JavaScript
tags:
  - JavaScript
---

如：随机字符串、数组去重、FormData 对象转化

<!-- more -->

### 随机字符串生成

```js
/**
 * 生成随机id
 * @param {*} length  number
 * @param {*} chars   string
 */
export function uuid(length, chars) {
  chars = chars || '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'
  length = length || 8
  var result = ''
  for (var i = length; i > 0; --i)
    result += chars[Math.floor(Math.random() * chars.length)]
  return result
}
```
> 第一个参数指定位数，第二个字符串指定字符，都是可选参数，如果都不传，默认生成8位
> ```js
> console.log(uuid(5))  // KFMLE
> // or
> console.log(uuid(5, '0123456789'))  // 83686
> ```

### 数组去重

```js
/**
 * 数组去重
 * @param {*} arr Array
 */
export function unique(arr) {
  if (!Array.isArray(arr)) {
    throw new Error('The first parameter must be an array')
  }
  if (arr.length == 1) {
    return arr
  }
  return [...new Set(arr)]
}
// unique([1,1,1,1,1])//[1]
```

### 对象转化为 FormData 对象

```js
/**
 * 对象转化为formdata
 * @param {Object} object
 */

export function getFormData(object) {
  const formData = new FormData()
  Object.keys(object).forEach((key) => {
    const value = object[key]
    if (Array.isArray(value)) {
      value.forEach((subValue, i) => formData.append(key + `[${i}]`, subValue))
    } else {
      formData.append(key, object[key])
    }
  })
  return formData
}
```
> 使用场景：在向后端请求时，如果上传的数据里存在file文件对象，需要用到表单提交时
> ```js
> let params = {
>   file: xxx,  // 文件
>   name: 'jack',
>   age: '36'
>   ...
> }
> getFormData(params)
> ```
